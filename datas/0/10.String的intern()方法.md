## 了解String.intern()方法吗？

面试官：说一下String.intern()干嘛用的？

我：去字符串常量池拿吃的

- jdk6：

执行intern()方法时，**若常量池中不存在等值的字符串，JVM就会在常量池中创建一个等值的字符串(这句话很重要)，然后返回该字符串的引用**。

- jdk7：

执行intern操作时，如果常量池已经存在该字符串，则直接返回字符串引用，否则**复制该堆中字符串对象的引用到常量池(堆对象引用复制到常量池)中并返回**。

简单说一下常量池版本的变化

### 1.6

- 静态常量池在Class文件中。
- **运行时常量池(常量池：字面量和符号引用)在Perm Gen区(也就是方法区)中**。
- **字符串常量池在运行时常量池**中。

### 1.7

- 静态常量池在Class文件中。
- **运行时常量池依然在Perm Gen区(也就是方法区)中**。在JDK7版本中，永久代的转移工作就已经开始了，将譬如符号引用转移到了native heap；字面量转移到了java heap；类的静态变量转移到了java heap。但是运行时常量池依然还存在，只是很多内容被转移，其只存着这些被转移的引用。
- **字符串常量池被分配到了Java堆的主要部分**。也就是**字符串常量池从运行时常量池分离出来了**。

### 1.8

- 静态常量池在Class文件中。
- **JVM已经将运行时常量池从方法区中移了出来，在Java堆（Heap）中开辟了一块区域存放运行时常量池**。**同时永久代被移除，以元空间代替**。元空间并不在虚拟机中，而是使用本地内存。因此，默认情况下，元空间的大小仅受本地内存限制。其主要用于存放一些元数据（类信息）。
- **字符串常量池存在于Java堆中**。